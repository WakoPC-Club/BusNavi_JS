<!doctype html>
<html lang="ja">
<meta charset="UTF-8">
<meta http-equiv="Refresh content=" 10;***>

<head>
  <link rel="stylesheet" href="style.css">
  <title>鶴川団地_時刻表</title>
  <script type="text/javascript">

    setTimeout("location.href='timeW.html'", 1000 * 10);

    var Nowdate = new Date();
    var NowHour = Nowdate.getHours();
    var NowMin = Nowdate.getMinutes();
    var NowSec = Nowdate.getSeconds();
    var NowDay = Nowdate.getDay();
    var Week = new Array("日", "月", "火", "水", "木", "金", "土");
    const Display_time = NowHour * 60 + NowMin;//ディスプレイに表示している時間
    const grace = 1;//何分後以降に出発するバスを表示する

  </script>
</head>

<h1 crass=houmen>鶴川駅方面　センター前、六丁目経由</h1>

<p class="watch">
  <script>
    document.writeln(Nowdate.getFullYear().toString() + "年" + (Nowdate.getMonth() + 1).toString() + "月" + Nowdate.getDate().toString() + "日(" + Week[NowDay] + ")" + NowHour + ":" + ('00' + NowMin).slice(-2));
  </script>
</p>

<script>
  //経由
  const busrouteMap = {
    00: '本日の運行は終了しました',
    11: '[鶴11] 鶴川駅行き　センター前経由',
    13: '[鶴13] 鶴川駅行き　六丁目経由',
    50: '[町50] 町田駅行き　鶴川駅経由',
    99: ''
  };

  //混雑度
  const congestionStatusMap = {
    11: 'あんまり',
    12: 'そこそこ',
    13: 'かなり',
    99: '',
  };

  // 時刻表
  var ary_timetable =
  [
    [ //平日
      [],//0
      [],//1
      [],//2
      [],//3
      [],//4
      [[40,11,11], [55,11,11]],//5
      [[05,11,11], [15,11,11], [20,11,11], [25,11,11], [30,13,11], [35,11,11], [40,11,11], [44,13,11], [48,11,11], [52,11,11], [56,11,11]],//6
      [[00,11,11], [04,11,11], [08,13,11], [12,11,11], [16,11,11], [20, 13, 11], [24,11,11], [28,11,11], [32,13,11], [36,11,11], [40,11,11], [44,13,11], [48,11,11], [52,11,11], [56,11,11]],//7
      [[00,13,11], [06,11,11], [12,13,11], [18,11,11], [24,13,11], [30,11,11], [36,13,11], [42,11,11], [48,13,11], [54,11,11]],//8
      [[00,13,11], [08,11,11], [16,13,11], [24,11,11], [32,13,11], [40,11,11], [48,13,11], [56,11,11]],//9
      [[05,11,11], [15,13,11], [25,11,11], [35,50,11], [45,13,11], [55,11,11]],//10
      [[05,11,11], [15,13,11], [25,11,11], [35,50,11], [45,13,11], [55,11,11]],//11
      [[05,11,11], [15,13,11], [25,11,11], [35,50,11], [45,13,11], [55,11,11]],//12
      [[05,11,11], [15,13,11], [25,11,11], [35,50,11], [45,13,11], [55,11,11]],//13
      [[05,11,11], [15,13,11], [25,11,11], [35,50,11], [45,13,11], [55,11,11]],//14
      [[05,11,11], [15,13,11], [25,11,11], [35,11,11], [45,13,11], [55,11,11]],//15
      [[05,13,11], [12,11,11], [19,13,11], [26,11,11], [33,13,11], [40,11,11], [47,13,11], [54,11,11]],//16
      [[00,13,11], [06,11,11], [12,13,11], [18,11,11], [24,13,11], [30,11,11], [36,13,11], [42,11,11], [48,13,11], [52,11,11]],//17
      [[00,11,11], [06,13,11], [12,11,11], [18,11,11], [24,13,11], [30,11,11], [36,11,11], [42,13,11], [48,11,11], [52,11,11]],//18
      [[00,11,11], [08,13,11], [16,11,11], [24,11,11], [32,11,11], [40,11,11], [48,13,11], [50,11,11]],//19
      [[05,11,11], [20,11,11], [35,13,11], [40,11,11], [50,11,11], [59,13,11]],//20
      [[10,11,11], [37,11,11], [45,11,11]],//21
      [[17,11,11], [45,11,11]],//22
      []//23
    ],

    [//土曜
      [],//0
      [],//1
      [],//2
      [],//3
      [],//4
      [[40,11,11]],//5
      [[00,11,11],[12,11,11],[24,11,11],[36,11,11],[48,13,11]],//6
      [[05,11,11],[12,13,11],[20,11,11],[27,13,11],[35,11,11],[42,13,11],[50,11,11],[57,13,11]],//7
      [[05,11,11],[12,13,11],[20,11,11],[27,13,11],[35,11,11],[42,13,11],[50,11,11],[57,13,11]],//8
      [[05,11,11],[15,13,11],[25,11,11],[35,11,11],[45,13,11],[55,11,11]],//9
      [[05,11,11],[15,13,11],[25,11,11],[35,50,11],[45,13,11],[55,11,11]],//10
      [[05,11,11],[15,13,11],[25,11,11],[35,50,11],[45,13,11],[55,11,11]],//11
      [[05,11,11],[15,13,11],[25,11,11],[35,50,11],[45,13,11],[55,11,11]],//12
      [[05,11,11],[15,13,11],[25,11,11],[35,50,11],[45,13,11],[55,11,11]],//13
      [[05,11,11],[15,13,11],[25,11,11],[35,50,11],[45,13,11],[55,11,11]],//14
      [[05,11,11],[15,13,11],[25,11,11],[35,11,11],[45,13,11],[55,11,11]],//15
      [[05,11,11],[12,13,11],[20,11,11],[27,11,11],[35,13,11],[42,11,11],[50,11,11],[57,13,11]],//16
      [[05,11,11],[12,11,11],[20,13,11],[27,11,11],[35,11,11],[42,13,11],[50,11,11],[57,11,11]],//17
      [[05,13,11],[12,11,11],[20,11,11],[27,13,11],[35,11,11],[42,11,11],[50,13,11],[57,11,11]],//18
      [[05,11,11],[12,13,11],[20,11,11],[27,11,11],[35,13,11],[42,11,11],[50,11,11],[57,13,11]],//19
      [[05,11,11],[20,11,11],[35,11,11],[50,11,11]],//20
      [[05,11,11],[25,11,11],[50,11,11]],//21
      [[15,11,11],[45,11,11]],//22
      []//23
    ],
    [//日曜
      [],//0
      [],//1
      [],//2
      [],//3
      [],//4
      [],//5
      [[00,11,11],[25,11,11],[50,11,11]],//6
      [[05,11,11],[12,13,11],[20,11,11],[27,13,11],[35,11,11],[42,13,11],[50,11,11],[57,13,11]],//7
      [[05,11,11],[12,13,11],[20,11,11],[27,13,11],[35,11,11],[42,13,11],[50,11,11],[57,13,11]],//8
      [[05,11,11],[15,13,11],[25,11,11],[35,11,11],[45,13,11],[55,11,11]],//9
      [[05,11,11],[15,13,11],[25,11,11],[35,50,11],[45,13,11],[55,11,11]],//10
      [[05,11,11],[15,13,11],[25,11,11],[35,50,11],[45,13,11],[55,11,11]],//11
      [[05,11,11],[15,13,11],[25,11,11],[35,50,11],[45,13,11],[55,11,11]],//12
      [[05,11,11],[15,13,11],[25,11,11],[35,50,11],[45,13,11],[55,11,11]],//13
      [[05,11,11],[15,13,11],[25,11,11],[35,50,11],[45,13,11],[55,11,11]],//14
      [[05,11,11],[15,13,11],[25,11,11],[35,11,11],[45,13,11],[55,11,11]],//15
      [[05,11,11],[12,13,11],[20,11,11],[27,11,11],[35,13,11],[42,11,11],[50,11,11],[57,13,11]],//16
      [[05,11,11],[12,11,11],[20,13,11],[27,11,11],[35,11,11],[42,13,11],[50,11,11],[57,11,11]],//17
      [[05,13,11],[12,11,11],[20,11,11],[27,13,11],[35,11,11],[42,11,11],[50,13,11],[57,11,11]],//18
      [[05,11,11],[12,13,11],[20,11,11],[27,11,11],[35,13,11],[42,11,11],[50,11,11],[57,13,11]],//19
      [[05,11,11],[20,11,11],[35,11,11],[50,11,11]],//20
      [[05,11,11],[25,11,11],[50,11,11]],//21
      [[15,11,11],[45,11,11]],//22
      [],//23
    ]
  ];


  var show = new Array(99, 99, 99, 99, 99, 99);
  var via = new Array(99, 99, 99, 99, 99, 99);
  var congestion = new Array(99, 99, 99, 99, 99, 99);
  var time_left = new Array(' ', ' ', ' ', ' ', ' ', ' ');

  var cc = 0;
  var columnsNumber = 6;
  var weekday_mode;

  if (NowDay === 0)
  {
    weekday_mode = 2;
  }
  else if (NowDay === 6)
  {
    weekday_mode = 1;
  }
  else
  {
    weekday_mode = 0;
  }

  var ary_hour_timetable = ary_timetable[weekday_mode][NowHour];//配列,現在Hのバス時刻表全取得

  for (i = 0; true; i++) {
    if (NowHour === 24)//24時に達した際のエスケープ
    {
      if (cc === 0) {
        via[0] = 00;
      }

      break;
    }

    if (ary_hour_timetable.length !== 0)//空配列のエスケープ
    {
      if (ary_hour_timetable.length === i) // OutOfLengthのエスケープ
      {
        NowHour++;
        NowMin = 0 - grace;

        ary_hour_timetable = ary_timetable[weekday_mode][NowHour];

        i = -1;
      }

      else if (NowMin + grace <= ary_hour_timetable[i][0])//Show処理
      {
        var Sd = ary_hour_timetable[i][0];

        show[cc] = NowHour + ":" + ('00' + Sd).slice(-2);//Show
        via[cc] = ary_hour_timetable[i][1];//Show
        congestion[cc] = ary_hour_timetable[i][2];//Show
        time_left[cc] = ((NowHour * 60 + Sd) - Display_time).toString() + '分';

        cc++;
      }

    }

    else {
      NowHour++;
      NowMin = 0 - grace;
      ary_hour_timetable = ary_timetable[weekday_mode][NowHour];
      i--;
    }

    if (cc === columnsNumber) break;

  }


  //時刻
  for (i = 0; i < show.length; i++) {
    switch (show[i]) {
      case 99:
        show[i] = "--:--"
        break;

    }
  }

  myTbl3 = new Array
    (
      "鶴川駅",
      "鶴川駅",
      "鶴川駅",
      "鶴川駅",
      "鶴川駅",
      "鶴川駅"
    );


  myTbl3 = congestion.map((value) => { return congestionStatusMap[value] });
  via = via.map((value) => { return busrouteMap[value] });

//-->
</script>

<body>
  <div>

    <table border="2" cellspacing="5" align="center">
      <tr>
        <th>出発時間</th>
        <th>行き先</th>
        <th>出発まで</th>

        <script type="text/javascript">

          for (i = 0; i < columnsNumber; i++) {
            document.write(`<tr class='TurukawaTable'> <td class='time'> ${show[i]} </td>`);//出発時間
            document.write(`<td class='keiyu'> ${via[i]} </td>`);//行先（経由）
            document.write(`<td class='nokori'> ${time_left[i]} </td>`);//出発時間まで
          }

      //-->
        </script>

      </tr>
    </table>

    <aside class=left>
      <p>
        <img src="koukoku_left.png" alt="左広告">
      </p>
    </aside>

    <aside class=right>
      <p>
        <img src="koukoku_right.png" alt="右広告">
      </p>
    </aside>



  </div>

</body>
<br>

</html>
